{% block data %}

<script src="{{ url_for('static', filename='js/vuefunctions.js') }}"></script>
<script src="{{ url_for('static', filename='js/jquery-ui.js') }}"></script>

<div class="row bg-title" id="vue_title">
  <!-- .page title -->
  <div class="col-lg-3 col-md-4 col-sm-4 col-xs-12">
     <h4 class="page-title" id="title1">{%raw%}{{Title}}{%endraw%}</h4>
  </div>
  <!-- /.page title -->
  <!-- .breadcrumb -->
  <div class="col-lg-9 col-sm-8 col-md-8 col-xs-12">
      <ol class="breadcrumb">
        <li><a href="#">Dashboard</a></li>
        <li class="active" id="title2">{%raw%}{{Title}}{%endraw%}</li>
     </ol>
  </div>
  <!-- /.breadcrumb -->
</div>


<div id="recordButtons">
  {% block buttons %}
    {% if getCanUserEdit(var['Table'],var['id']) %}
      <button class="btn btn-info btn-rounded waves-effect waves-light m-r-10 m-b-10" onclick="saveRecord('record_form','{{var['Table']}}')" >
        <span class="btn-label">
          <i class="fa fa-check">
          </i>
        </span>Grabar
      </button>
    {% endif %}
    {% if getCanUserDelete(var['Table']) %}
      <button onclick="deleteRecord('record_form','{{var['Table']}}','recordForm')" class="btn btn-danger btn-rounded waves-effect waves-light m-r-10 m-b-10" >
        <span class="btn-label">
          <i class="fa fa-minus">
          </i>
        </span>Borrar
      </button>
    {% endif %}
    {% block add_buttons %}
    {% endblock %}
  {% endblock %}
  <div id="messages">
    <p v-if="error_msg" class="alert alert-danger" >{% raw %}{{error_msg}}{% endraw %}</p>
    <p v-if="success_msg" class="alert alert-success">{% raw %}{{success_msg}}{% endraw %}</p>
  </div>
</div>

{% block fields %}
<div id="recordFields">
  <form action="/" autocomplete="off" class="form-material form-horizontal" id="record_form">
  <input id="_state" name="_state" type="hidden" v-model="values._state">
  <input v-if="values.record" id="syncVersion" name="syncVersion" type="hidden" v-model="values.record.syncVersion">
    <div class="row" v-for="tab in values.htmlView">
      <div class="col-xs-12">
        <div class="white-box">
          <h3 class="box-title"> {% raw %} {{tab.Name}} {% endraw %}</h3>
            <div class="form-group" v-for="tab_fields in tab.Fields">
              <div :class="'col-xs-12 col-md-' + tab_fields[0] + ' p-0'" v-for="field in tab_fields[1]"
                v-if="values.fields[field] && !(values.fields[field]['Type'] instanceof Array)">
                <label class="col-xs-12" :for="field"
                  v-if="(values.fields[field]['Label']) && (values.fields[field]['Input'] != 'checkbox')"  >
                  {% raw %} {{values.fields[field]['Label']}} {% endraw %}
                </label>
                <div class="col-xs-12">

                  <input v-if="values.fields[field]['Input'] == 'Hidde'" class="form-control" :id="field"
                    :name="field" type="hidden" v-model="values.record[field]"
                    >

                  <input v-if="values.fields[field]['Input'] == 'text'" class="form-control" :id="field"
                    :name="field" :placeholder="values.fields[field]['Label']" type="text" v-model="values.record[field]"
                    :readOnly="(values.fields[field]['Readonly']==1 && values._state==1) || (values.fields[field]['Readonly']==2)"
                    >

                  <input v-if="values.fields[field]['Input'] == 'number'" class="form-control" :id="field"
                    :name="field" :placeholder="values.fields[field]['Label']" type="number" v-model="values.record[field]"
                    :readOnly="(values.fields[field]['Readonly']==1 && values._state==1) || (values.fields[field]['Readonly']==2)"
                    >

                  <input v-if="values.fields[field]['Input'] == 'date'" class="form-control" :id="field"
                    :name="field" :placeholder="values.fields[field]['Label']" type="date" v-model="values.record[field]"
                    :readOnly="(values.fields[field]['Readonly']==1 && values._state==1) || (values.fields[field]['Readonly']==2)"
                    >

                  <input v-if="values.fields[field]['Input'] == 'time'" class="form-control" :id="field"
                    :name="field" :placeholder="values.fields[field]['Label']" type="time" v-model="values.record[field]"
                    :readOnly="(values.fields[field]['Readonly']==1 && values._state==1) || (values.fields[field]['Readonly']==2)"
                    >

                  <input v-if="values.fields[field]['Input'] == 'datetime'" class="form-control" :id="field"
                    :name="field" :placeholder="values.fields[field]['Label']" type="datetime" v-model="values.record[field]"
                    :readOnly="(values.fields[field]['Readonly']==1 && values._state==1) || (values.fields[field]['Readonly']==2)"
                    >

                  <input v-if="values.fields[field]['Input'] == 'password'" class="form-control" :id="field"
                    :name="field" :placeholder="values.fields[field]['Label']" type="password" v-model="values.record[field]"
                    :readOnly="(values.fields[field]['Readonly']==1 && values._state==1) || (values.fields[field]['Readonly']==2)"
                    >

                  <input v-if="values.fields[field]['Input'] == 'integer'" class="form-control" :id="field"
                    :name="field" :placeholder="values.fields[field]['Label']" type="integer" v-model="values.record[field]"
                    onkeypress='return event.charCode >= 48 && event.charCode <= 57'
                    :readOnly="(values.fields[field]['Readonly']==1 && values._state==1) || (values.fields[field]['Readonly']==2)"
                    >

                  <textarea v-if="values.fields[field]['Input'] == 'textarea'" class="form-control" :id="field"
                    :name="field" :rows="values.fields[field]['rows']" v-model="values.record[field]"
                    :readOnly="(values.fields[field]['Readonly']==1 && values._state==1) || (values.fields[field]['Readonly']==2)"
                    ></textarea>

                  <div v-if="values.fields[field]['Input'] == 'fileinput'" class="fileinput fileinput-new input-group"
                  data-provides="fileinput" onchange="checkFileSize(this)">
                    <div class="form-control" data-trigger="fileinput">
                      <i class="glyphicon glyphicon-file fileinput-exists"></i>
                      <span class="fileinput-filename" :id="field" :name="field"></span>
                    </div>
                    <span class="input-group-addon btn btn-default btn-file">
                      <span class="fileinput-new">Seleccionar Archivo</span>
                      <span class="fileinput-exists">Cambiar</span>
                      <span class="fileinput-exists">Cambiar</span>
                      <input id="ImageProfile-file" name="{{field}}-file" type="file"
                      :readOnly="(values.fields[field]['Readonly']==1 && values._state==1) || (values.fields[field]['Readonly']==2)"
                      >
                    </span>
                    <a class="input-group-addon btn btn-default fileinput-exists" data-dismiss="fileinput" href="#">Quitar</a>
                  </div>

                  <select v-if="values.fields[field]['Input'] == 'combo' && values.fields[field]['Values']"
                    class="form-control" :id="field" :name="field" v-model="values.record[field]"
                    :readOnly="(values.fields[field]['Readonly']==1 && values._state==1) || (values.fields[field]['Readonly']==2)"
                    >
                    <option v-for="(value,key) in values.fields[field]['Values']" :value="key">
                      {% raw %} {{value}} {% endraw %}</option>
                  </select>

                  <!--select v-if="values.fields[field]['Input'] == 'combo' && values.fields[field]['LinkTo'] && values.links[field]"
                    class="form-control" :id="field" :name="field" v-model="values.record[field]"
                    :readOnly="(values.fields[field]['Readonly']==1 && values._state==1) || (values.fields[field]['Readonly']==2)"
                    >
                    <option v-for="(value,key) in values.links[field]"  :value="key">
                      {% raw %} {{value}} {% endraw %}</option>
                  </select-->

                  <input v-if="values.fields[field]['Input'] == 'combo' && values.fields[field]['LinkTo'] && values.links[field]"
                    class="form-control" :id="field" :name="field" v-model="values.record[field]" autocomplete="off"
                    :readOnly="(values.fields[field]['Readonly']==1 && values._state==1) || (values.fields[field]['Readonly']==2)"
                  >

                  <div v-if="values.fields[field]['Input'] == 'checkbox'"  class="checkbox checkbox-primary">
                    <input class="fxhdr" :id="field" :name="field" type="checkbox" v-model="values.record[field]"
                      :onClick="values.fields[field]['onClick']"
                      :disabled="(values.fields[field]['Readonly']==1 && values._state==1) || (values.fields[field]['Readonly']==2)"
                      >
                    <label v-if="values.fields[field]['Label']"
                    :for="field">{% raw %} {{values.fields[field]['Label']}} {% endraw %}</label>
                  </div>

                </div>
              </div>

              <div :class="'col-xs-12 col-md-' + tab_fields[0] + ' p-0'" v-for="field in tab_fields[1]" :id="field"
                v-if="values.fields[field] && (values.fields[field]['Type'] instanceof Array)">
                <label class="col-xs-12" :for="field"
                  v-if="(values.fields[field]['Label']) && (values.fields[field]['Input'] != 'checkbox')"  >
                  {% raw %} {{values.fields[field]['Label']}} {% endraw %}
                </label>

                <div v-for="(row,index) in values.record[field]" :id="'row'+(index+1)"
                   :name="field+'Rows'" :rownr="index+1" class="col-xs-12">


                  <div class="col-xs-6 col-md-1"
                    v-if="!values.fields[field].fieldsDefinition[dfield].Hidde"
                    v-for="dfield in values.fields[field].fieldsDefinition.__order__">
                    <label
                    v-if="values.fields[field].fieldsDefinition[dfield].Input!='checkbox'">
                    {% raw %} {{values.fields[field].fieldsDefinition[dfield].Label}} {% endraw %}</label>

                    <input v-if="values.fields[field].fieldsDefinition[dfield].Input=='time'"
                    :detail="field" :id="dfield" :name="dfield"
                    type="time" class="form-control" v-model="values.record[field][index][dfield]"
                    :readOnly="(values.fields[field].fieldsDefinition[dfield]['Readonly']==1 && values._state==1)
                    || (values.fields[field].fieldsDefinition[dfield]['Readonly']==2)"
                    >

                    <select v-if="values.fields[field].fieldsDefinition[dfield].Input == 'combo'
                      && values.fields[field].fieldsDefinition[dfield]['LinkTo'] && values.links[dfield] "
                      :detail="field" :id="dfield" :name="dfield"
                      class="form-control" v-model="values.record[field][index][dfield]"
                      :readOnly="(values.fields[field].fieldsDefinition[dfield]['Readonly']==1 && values._state==1)
                      || (values.fields[field].fieldsDefinition[dfield]['Readonly']==2)"
                      >
                      <option v-for="(value,key) in values.links[dfield]"  :value="key">
                        {% raw %} {{value}} {% endraw %}</option>
                    </select>


                    <div class="col-xs-3 col-md1 checkbox checkbox-primary"
                      v-if="values.fields[field].fieldsDefinition[dfield].Input=='checkbox'">
                      <input :detail="field" :id="dfield" :name="field"
                      type="checkbox" value="0" v-model="values.record[field][index][dfield]" class="form-control"
                      :readOnly="(values.fields[field].fieldsDefinition[dfield]['Readonly']==1 && values._state==1)
                      || (values.fields[field].fieldsDefinition[dfield]['Readonly']==2)"
                      >
                      <label v-if="values.fields[field].fieldsDefinition[dfield].Label"
                      :labelfor="dfield">{% raw %} {{values.fields[field].fieldsDefinition[dfield].Label}} {% endraw %}</label>
                    </div>


                  </div>


                  <div class="col-lg-1 col-xs-6 col-md-1">
                    <button :id="'delete'+index" v-on:click="removeRow(field,index)" type="button"
                      class="btn btn-danger btn-rounded waves-effect waves-light">
                      Borrar
                      <span clas="btn-label">
                        <i class="fa fa-times"></i>
                      </span>
                    </button>
                  </div>
                </div>
                <button :onclick="'addNewRow(&quot;'+field+'&quot;)'" type="button"
                  class="btn btn-warning btn-rounded waves-effect waves-light">
                  Agregar<span clas="btn-label"><i class="fa fa-times"></i>
                  </span>
                </button>

              </div>

            </div>
        </div>
      </div>
    </div>
  </div>
</div>

<div>
  <input id="tags3" class="form-control" autocomplete="off">
</div>

{% endblock %}

{% endblock %}


